<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <title>Bina Marga | Provinsi Kalimantan Timur</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta content="Coderthemes" name="author" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- App favicon -->
    <link rel="shortcut icon" href="assets/images/favicon.ico">

    <!-- C3 Chart css -->
    <link href="assets/libs/c3/c3.min.css" rel="stylesheet" type="text/css" />

    <!-- App css -->
    <link href="assets/css/bootstrap.min.css" rel="stylesheet" type="text/css" id="bootstrap-stylesheet" />
    <link href="assets/css/icons.min.css" rel="stylesheet" type="text/css" />
    <link href="assets/css/app.min.css" rel="stylesheet" type="text/css" id="app-stylesheet" />

</head>

<body data-layout="horizontal">

    <!-- Begin page -->
    <div id="wrapper">

        <!-- Navigation Bar-->
        <header id="topnav">
            <!-- Topbar Start -->
            <div class="navbar-custom">
                <div class="container-fluid">
                    <ul class="list-unstyled topnav-menu float-right mb-0">

                        <li class="dropdown notification-list">
                            <!-- Mobile menu toggle-->
                            <a class="navbar-toggle nav-link">
                                <div class="lines">
                                    <span></span>
                                    <span></span>
                                    <span></span>
                                </div>
                            </a>
                            <!-- End mobile menu toggle-->
                        </li>


                        <!-- <li class="dropdown notification-list">
                            <a href="javascript:void(0);" class="nav-link right-bar-toggle waves-effect waves-light">
                                <i class="fe-settings noti-icon"></i>
                            </a>
                        </li> -->
                        <li class="dropdown notification-list d-none d-md-block">
                            <a class="nav-link" href="index.html" style="padding: 0 10px;">
                                <img src="assets/images/zi.png" alt="Logo" height="40" style="vertical-align: middle;">
                            </a>
                        </li>
                        <li class="dropdown notification-list d-none d-md-block">
                            <a class="nav-link" href="index.html" style="padding: 0 10px;">
                                <img src="assets/images/berakhlak.png" alt="Logo" height="40" style="vertical-align: middle;">
                            </a>
                        </li>

                    </ul>

                    <!-- LOGO -->
                    <div class="logo-box">

                        <a href="index.html" class="logo text-center logo-dark">
                            <span class="logo-lg">
                                <img src="assets/images/logo-dark.png" alt="" height="50">
                                <!-- <span class="logo-lg-text-dark">Adminox</span> -->
                            </span>
                            <span class="logo-sm">
                                <!-- <span class="logo-lg-text-dark">A</span> -->
                                <img src="assets/images/logo-sm.png" alt="" height="50">
                            </span>
                        </a>

                        <a href="index.html" class="logo text-center logo-light">
                            <span class="logo-lg">
                                <img src="assets/images/logo-light.png" alt="" height="50">
                                <!-- <span class="logo-lg-text-dark">Adminox</span> -->
                            </span>
                            <span class="logo-sm">
                                <!-- <span class="logo-lg-text-dark">A</span> -->
                                <img src="assets/images/logo-sm.png" alt="" height="50">
                            </span>
                        </a>
                    </div>

                    <div class="clearfix"></div>
                </div>
            </div>
            <!-- end Topbar -->

            <div class="topbar-menu">
                <div class="container-fluid">
                    <div id="navigation">
                        <!-- Navigation Menu-->
                        <ul class="navigation-menu">

                            <li class="">
                                <a href="index.html"> <i class="fe-airplay"></i>Beranda</a>
                            </li>

                            <li class="">
                                <a href="webgis.html">
                                    <i class="fe-map-pin"></i>WebGIS
                                </a>
                            </li>

                            <li class="">
                                <a href="data.html">
                                    <i class="fe-database"></i>Data Jembatan</a>
                            </li>

                            <li class="">
                                <a href="#"><i class="fe-plus-square"></i>Extras</a>

                            </li>
                        </ul>
                        <!-- End navigation menu -->

                        <div class="clearfix"></div>
                    </div>
                    <!-- end #navigation -->
                </div>
                <!-- end container -->
            </div>
            <!-- end navbar-custom -->
        </header>
        <!-- End Navigation Bar-->

        <!-- ============================================================== -->
        <!-- Start Page Content here -->
        <!-- ============================================================== -->

        <div class="content-page">
            <div class="content">

                <!-- Start Content-->
                <div class="container-fluid">

                    <!-- start page title -->
                    <div class="row">
                        <div class="col-12">
                            <div class="page-title-box">
                                <!-- <div class="page-title-right">
                                    <ol class="breadcrumb m-0">
                                        <li class="breadcrumb-item"><a href="javascript: void(0);">Dashboard</a></li>
                                    </ol>
                                </div> -->
                                <h4 class="page-title">Data Jembatan</h4>
                            </div>
                        </div>
                    </div>
                    <!-- end page title -->

                    <div class="row">

                        <div class="col-xl-3 col-sm-6">
                            <a href="data.html" style="text-decoration: none;">
                                <div class="card-box widget-box-two widget-two-custom">
                                    <div class="media">
                                        <div class="avatar-lg rounded-circle bg-info widget-two-icon align-self-center">
                                            <i class="fe-circle avatar-title font-30 text-white"></i>
                                        </div>
                                        <div class="wigdet-two-content media-body text-center">
                                            <h2 class="font-weight-large">1,247</h2>
                                            <h5 class="m-0">Total Jembatan</h5>
                                        </div>
                                    </div>
                                </div>
                            </a>
                        </div>
                        <!-- end col -->

                        <div class="col-xl-3 col-sm-6">
                            <div class="card-box widget-box-two widget-two-custom ">
                                <div class="media">
                                    <div class="avatar-lg rounded-circle bg-success widget-two-icon align-self-center">
                                        <i class="fe-check-circle avatar-title font-30 text-white"></i>
                                    </div>

                                    <div class="wigdet-two-content media-body text-center">
                                        <h2 class="font-weight-large">829</h2>
                                        <h5 class="m-0">Kondisi Baik</h5>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- end col -->

                        <div class="col-xl-3 col-sm-6">
                            <div class="card-box widget-box-two widget-two-custom ">
                                <div class="media">
                                    <div class="avatar-lg rounded-circle bg-warning widget-two-icon align-self-center">
                                        <i class="fe-alert-triangle avatar-title font-30 text-white"></i>
                                    </div>

                                    <div class="wigdet-two-content media-body text-center">
                                        <h2 class="font-weight-large">255</h2>
                                        <h5 class="m-0">Perlu Perbaikan</h5>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- end col -->

                        <div class="col-xl-3 col-sm-6">
                            <div class="card-box widget-box-two widget-two-custom ">
                                <div class="media">
                                    <div class="avatar-lg rounded-circle bg-danger widget-two-icon align-self-center">
                                        <i class="fe-x-circle  avatar-title font-30 text-white"></i>
                                    </div>

                                    <div class="wigdet-two-content media-body text-center">
                                        <h2 class="font-weight-large">100</h2>
                                        <h5 class="m-0">Kondisi Kritis</h5>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                    <!-- end row -->

                    <div class="row">
                        <div class="col-xl-5">
                            <div class="card-box">
                                <h4 class="header-title mb-4">Peta Sebaran Jembatan</h4>
                                <div id="map-jembatan"
                                    style="width: 100%; height: 750px; border-radius: 8px; overflow: hidden; background: #e9ecef;">
                                    <!-- Peta akan ditampilkan di sini -->
                                    <!-- Leaflet CSS & JS -->
                                    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
                                    <link rel="stylesheet"
                                        href="https://unpkg.com/leaflet.markercluster/dist/MarkerCluster.css" />
                                    <link rel="stylesheet"
                                        href="https://unpkg.com/leaflet.markercluster/dist/MarkerCluster.Default.css" />
                                    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
                                    <script
                                        src="https://unpkg.com/leaflet.markercluster/dist/leaflet.markercluster.js"></script>

                                    <div id="leaflet-map" style="width:100%;height:100%;"></div>
                                    <script>
                                        // Dummy bridge data
                                        const bridges = [
                                            {
                                                kode_ruas: "P.34.00.001",
                                                nama_ruas: "Jalan Teuku Umar Lok Bahu",
                                                nomor: "P.34.00.001",
                                                name: "Jembatan Mahakam",
                                                panjang: 710,
                                                lebar: 15,
                                                desa: "Lok Bahu",
                                                kecamatan: "Samarinda Ulu",
                                                kabupaten: "Samarinda",
                                                upt: "UPT Samarinda",
                                                lat: -0.501841,
                                                lng: 117.114566
                                            },
                                            {
                                                kode_ruas: "P.34.00.002",
                                                nama_ruas: "Jalan Tenggarong",
                                                nomor: "P.34.00.002",
                                                name: "Jembatan Kartanegara",
                                                panjang: 1022,
                                                lebar: 21,
                                                desa: "Tenggarong",
                                                kecamatan: "Tenggarong",
                                                kabupaten: "Kutai Kartanegara",
                                                upt: "UPT Tenggarong",
                                                lat: -0.4416,
                                                lng: 116.9916
                                            },
                                            {
                                                kode_ruas: "P.34.00.003",
                                                nama_ruas: "Jalan Pulau Balang",
                                                nomor: "P.34.00.003",
                                                name: "Jembatan Pulau Balang",
                                                panjang: 540,
                                                lebar: 12,
                                                desa: "Karang Joang",
                                                kecamatan: "Balikpapan Utara",
                                                kabupaten: "Balikpapan",
                                                upt: "UPT Balikpapan",
                                                lat: -1.1861,
                                                lng: 116.8897
                                            },
                                            {
                                                kode_ruas: "P.34.00.004",
                                                nama_ruas: "Jalan Sungai Wain",
                                                nomor: "P.34.00.004",
                                                name: "Jembatan Sungai Wain",
                                                panjang: 280,
                                                lebar: 8,
                                                desa: "Sungai Wain",
                                                kecamatan: "Balikpapan Utara",
                                                kabupaten: "Balikpapan",
                                                upt: "UPT Balikpapan",
                                                lat: -1.2050,
                                                lng: 116.9080
                                            },
                                            {
                                                kode_ruas: "P.34.00.005",
                                                nama_ruas: "Jalan Benuo Taka",
                                                nomor: "P.34.00.005",
                                                name: "Jembatan Benuo Taka",
                                                panjang: 450,
                                                lebar: 14,
                                                desa: "Benuo Taka",
                                                kecamatan: "Penajam",
                                                kabupaten: "Penajam Paser Utara",
                                                upt: "UPT Penajam",
                                                lat: -1.2745,
                                                lng: 116.3467
                                            },
                                            {
                                                kode_ruas: "P.34.00.006",
                                                nama_ruas: "Jalan Kutai Barat",
                                                nomor: "P.34.00.006",
                                                name: " Simp. 4 Jalan Teuku Umar Lok Bahu, Samarinda",
                                                panjang: 350,
                                                lebar: 10,
                                                desa: "Melak",
                                                kecamatan: "Melak",
                                                kabupaten: "Kutai Barat",
                                                upt: "UPT Kutai Barat",
                                                lat: -0.1467,
                                                lng: 115.8820
                                            },
                                            {
                                                kode_ruas: "P.34.00.007",
                                                nama_ruas: "Jalan Berau",
                                                nomor: "P.34.00.007",
                                                name: "Jembatan Berau",
                                                panjang: 400,
                                                lebar: 11,
                                                desa: "Tanjung Redeb",
                                                kecamatan: "Tanjung Redeb",
                                                kabupaten: "Berau",
                                                upt: "UPT Berau",
                                                lat: 2.1557,
                                                lng: 117.4962
                                            },
                                            {
                                                kode_ruas: "P.34.00.008",
                                                nama_ruas: "Jalan Bontang",
                                                nomor: "P.34.00.008",
                                                name: "Jembatan Bontang",
                                                panjang: 320,
                                                lebar: 9,
                                                desa: "Bontang Kuala",
                                                kecamatan: "Bontang Utara",
                                                kabupaten: "Bontang",
                                                upt: "UPT Bontang",
                                                lat: 0.1333,
                                                lng: 117.4833
                                            },
                                            {
                                                kode_ruas: "P.34.00.009",
                                                nama_ruas: "Jalan Tanah Grogot",
                                                nomor: "P.34.00.009",
                                                name: "Jembatan Paser",
                                                panjang: 500,
                                                lebar: 13,
                                                desa: "Tanah Grogot",
                                                kecamatan: "Tanah Grogot",
                                                kabupaten: "Paser",
                                                upt: "UPT Paser",
                                                lat: -1.8721,
                                                lng: 116.2550
                                            },
                                            {
                                                kode_ruas: "P.34.00.010",
                                                nama_ruas: "Jalan Kutai Timur",
                                                nomor: "P.34.00.010",
                                                name: "Jembatan Kutai Timur",
                                                panjang: 600,
                                                lebar: 12,
                                                desa: "Sangatta",
                                                kecamatan: "Sangatta Utara",
                                                kabupaten: "Kutai Timur",
                                                upt: "UPT Kutai Timur",
                                                lat: 0.5300,
                                                lng: 117.4650
                                            },
                                            {
                                                kode_ruas: "P.34.00.011",
                                                nama_ruas: "Jalan Mahakam Ulu",
                                                nomor: "P.34.00.011",
                                                name: "Jembatan Mahakam Ulu",
                                                panjang: 350,
                                                lebar: 10,
                                                desa: "Long Bagun",
                                                kecamatan: "Long Bagun",
                                                kabupaten: "Mahakam Ulu",
                                                upt: "UPT Mahakam Ulu",
                                                lat: 0.6172,
                                                lng: 114.8139
                                            },
                                            {
                                                kode_ruas: "P.34.00.012",
                                                nama_ruas: "Jalan Loa Janan",
                                                nomor: "P.34.00.012",
                                                name: "Jembatan Loa Janan",
                                                panjang: 420,
                                                lebar: 11,
                                                desa: "Loa Janan",
                                                kecamatan: "Loa Janan",
                                                kabupaten: "Kutai Kartanegara",
                                                upt: "UPT Kutai Kartanegara",
                                                lat: -0.7322,
                                                lng: 117.0731
                                            },
                                            {
                                                kode_ruas: "P.34.00.013",
                                                nama_ruas: "Jalan Samboja",
                                                nomor: "P.34.00.013",
                                                name: "Jembatan Samboja",
                                                panjang: 390,
                                                lebar: 10,
                                                desa: "Samboja",
                                                kecamatan: "Samboja",
                                                kabupaten: "Kutai Kartanegara",
                                                upt: "UPT Kutai Kartanegara",
                                                lat: -1.0733,
                                                lng: 117.0550
                                            },
                                            {
                                                kode_ruas: "P.34.00.014",
                                                nama_ruas: "Jalan Muara Badak",
                                                nomor: "P.34.00.014",
                                                name: "Jembatan Muara Badak",
                                                panjang: 370,
                                                lebar: 9,
                                                desa: "Muara Badak",
                                                kecamatan: "Muara Badak",
                                                kabupaten: "Kutai Kartanegara",
                                                upt: "UPT Kutai Kartanegara",
                                                lat: 0.4822,
                                                lng: 117.4567
                                            },
                                            {
                                                kode_ruas: "P.34.00.015",
                                                nama_ruas: "Jalan Penajam",
                                                nomor: "P.34.00.015",
                                                name: "Jembatan Penajam",
                                                panjang: 410,
                                                lebar: 12,
                                                desa: "Penajam",
                                                kecamatan: "Penajam",
                                                kabupaten: "Penajam Paser Utara",
                                                upt: "UPT Penajam",
                                                lat: -1.2889,
                                                lng: 116.3489
                                            },
                                            {
                                                kode_ruas: "P.34.00.016",
                                                nama_ruas: "Jalan Talisayan",
                                                nomor: "P.34.00.016",
                                                name: "Jembatan Talisayan",
                                                panjang: 330,
                                                lebar: 8,
                                                desa: "Talisayan",
                                                kecamatan: "Talisayan",
                                                kabupaten: "Berau",
                                                upt: "UPT Berau",
                                                lat: 2.0833,
                                                lng: 117.6833
                                            }
                                        ];

                                        // Initialize map
                                        var map = L.map('leaflet-map').setView([-0.5, 117.1], 7);

                                        // Add OpenStreetMap tile layer
                                        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                                            attribution: '&copy; OpenStreetMap contributors'
                                        }).addTo(map);

                                        // Create marker cluster group
                                        var markers = L.markerClusterGroup();

                                        // Store marker references by bridge name
                                        var markerRefs = {};

                                        // Add markers
                                        bridges.forEach(function (bridge) {
                                            var marker = L.marker([bridge.lat, bridge.lng])
                                                .on('click', function () {
                                                    showBridgeModal(bridge);
                                                })
                                                .bindTooltip(
                                                    `<strong>${bridge.name}</strong><br>Klik untuk detail data`,
                                                    {permanent: false, direction: 'top', className: 'leaflet-tooltip-custom'}
                                                );
                                            markers.addLayer(marker);
                                            markerRefs[bridge.name] = marker;
                                        });

                                        // Modal HTML (once, outside map)
                                        if (!document.getElementById('bridgeModal')) {
                                            var modalHtml = `
                                                <div class="modal fade" id="bridgeModal" tabindex="-1" role="dialog" aria-labelledby="bridgeModalLabel" aria-hidden="true">
                                                <div class="modal-dialog modal-lg" role="document">
                                                    <div class="modal-content">
                                                    <div class="modal-header">
                                                        <h5 class="modal-title" id="bridgeModalLabel">Detail Jembatan</h5>
                                                        <button type="button" class="close" data-dismiss="modal" aria-label="Close" onclick="closeBridgeModal()">
                                                        <span aria-hidden="true">&times;</span>
                                                        </button>
                                                    </div>
                                                    <div class="modal-body">
                                                        <ul class="nav nav-tabs" id="bridgeTab" role="tablist">
                                                        <li class="nav-item">
                                                            <a class="nav-link active" id="umum-tab" data-toggle="tab" href="#umum" role="tab" aria-controls="umum" aria-selected="true">Informasi Umum</a>
                                                        </li>
                                                        <li class="nav-item">
                                                            <a class="nav-link" id="khusus-tab" data-toggle="tab" href="#khusus" role="tab" aria-controls="khusus" aria-selected="false">Tipe/Kondisi Jembatan</a>
                                                        </li>
                                                        <li class="nav-item">
                                                            <a class="nav-link" id="foto-tab" data-toggle="tab" href="#foto" role="tab" aria-controls="foto" aria-selected="false">Foto</a>
                                                        </li>
                                                        </ul>
                                                        <div class="tab-content mt-3" id="bridgeTabContent">
                                                        <div class="tab-pane fade show active" id="umum" role="tabpanel" aria-labelledby="umum-tab">
                                                            <table class="table table-sm">
                                                            <tbody id="umum-content"></tbody>
                                                            </table>
                                                        </div>
                                                        <div class="tab-pane fade" id="khusus" role="tabpanel" aria-labelledby="khusus-tab">
                                                            <table class="table table-sm">
                                                            <tbody id="khusus-content"></tbody>
                                                            </table>
                                                        </div>
                                                        <div class="tab-pane fade" id="foto" role="tabpanel" aria-labelledby="foto-tab">
                                                            <div id="foto-content" class="text-center"></div>
                                                        </div>
                                                        </div>
                                                    </div>
                                                    </div>
                                                </div>
                                                </div>`;
                                            var modalDiv = document.createElement('div');
                                            modalDiv.innerHTML = modalHtml;
                                            document.body.appendChild(modalDiv);
                                        }

                                        // Show modal with bridge info
                                        function showBridgeModal(bridge) {
                                            // Umum tab content
                                            document.getElementById('umum-content').innerHTML = `
                                                <tr><th>Nama Jembatan</th><td>${bridge.name || '-'}</td></tr>
                                                <tr><th>Nomor Jembatan</th><td>${bridge.nomor || '-'}</td></tr>
                                                <tr><th>Kode Ruas</th><td>${bridge.kode_ruas || '-'}</td></tr>
                                                <tr><th>Nama Ruas</th><td>${bridge.nama_ruas || '-'}</td></tr>
                                                <tr><th>Desa/Kelurahan</th><td>${bridge.desa || '-'}</td></tr>
                                                <tr><th>Kecamatan</th><td>${bridge.kecamatan || '-'}</td></tr>
                                                <tr><th>Kabupaten/Kota</th><td>${bridge.kabupaten || '-'}</td></tr>
                                                <tr><th>UPT</th><td>${bridge.upt || '-'}</td></tr>
                                                <tr><th>Latitude</th><td>${bridge.lat || '-'}</td></tr>
                                                <tr><th>Longitude</th><td>${bridge.lng || '-'}</td></tr>
                                            `;
                                            // Khusus tab content (dummy)
                                            document.getElementById('khusus-content').innerHTML = `
                                            <tr>
                                                <td colspan="2" class="text-center">
                                                    <img src="assets/images/jmbt/5.png" alt="Tipe Jembatan" style="max-width:100%;max-height:320px;display:block;margin:0 auto 10px;">
                                                </td>
                                            </tr>
                                                <tr><th>Type Bangunan Atas</th><td>${bridge.type_bangunan_atas || 'Gelagar Komposit'}</td></tr>
                                                <tr><th>Kondisi Bangunan Atas</th><td>${bridge.kondisi_bangunan_atas || 'Baik'}</td></tr>
                                                <tr><th>Type Bangunan Bawah</th><td>${bridge.type_bangunan_bawah || 'Abutment'}</td></tr>
                                                <tr><th>Kondisi Bangunan Bawah</th><td>${bridge.kondisi_bangunan_bawah || 'Baik'}</td></tr>
                                                <tr><th>Type Pondasi</th><td>${bridge.type_pondasi || 'Langsung'}</td></tr>
                                                <tr><th>Kondisi Pondasi</th><td>${bridge.kondisi_pondasi || 'Baik'}</td></tr>
                                                <tr><th>Type Lantai</th><td>${bridge.type_lantai || 'Beton Bertulang'}</td></tr>
                                                <tr><th>Kondisi Lantai</th><td>${bridge.kondisi_lantai || 'Baik'}</td></tr>
                                                <tr><th>Nilai Kondisi</th><td>${bridge.nilai_kondisi || '5'}</td></tr>
                                                <tr>
                                                    <th>Kesimpulan Kondisi Jembatan</th>
                                                    <td>
                                                        <span class="badge badge-success" style="font-size:1.2rem; font-weight:bold;">
                                                            ${bridge.kesimpulan_kondisi || 'Baik'}
                                                        </span>
                                                    </td>
                                                </tr>
                                                <tr><th colspan="2"><strong>Kondisi Lingkungan</strong></th></tr>
                                                <tr><th style="padding-left:2em;">Elevasi Jembatan</th><td>${bridge.elevasi_jembatan || '-'}</td></tr>
                                                <tr><th style="padding-left:2em;">Elevasi Muka Air Banjir</th><td>${bridge.elevasi_muka_air_banjir || '-'}</td></tr>
                                                <tr><th style="padding-left:2em;">Elevasi Muka Air Normal</th><td>${bridge.elevasi_muka_air_normal || '-'}</td></tr>
                                            `;
                                            // Foto tab content (dummy image)
                                            document.getElementById('foto-content').innerHTML = bridge.foto && bridge.foto.trim() !== ''
                                                ? bridge.foto.split(',').map(src => `<img src="${src.trim()}" alt="Foto Jembatan" class="img-fluid m-1 bridge-photo" style="max-height:150px;cursor:pointer;">`).join('')
                                                : [
                                                    "assets/images/jmbt/1.png",
                                                    "assets/images/jmbt/2.png",
                                                    "assets/images/jmbt/3.png",
                                                    "assets/images/jmbt/4.png"
                                                ].map(src => `<img src="${src}" alt="Foto Jembatan" class="img-fluid m-1 bridge-photo" style="max-height:150px;cursor:pointer;">`).join('');

                                                // Tambahkan event listener untuk membesarkan foto saat diklik
                                                setTimeout(function() {
                                                    var imgs = document.querySelectorAll('#foto-content .bridge-photo');
                                                    imgs.forEach(function(img) {
                                                        img.onclick = function() {
                                                            // Cek dan hapus modal foto jika sudah ada
                                                            var oldModal = document.getElementById('photoModal');
                                                            if (oldModal) oldModal.remove();

                                                            // Buat modal foto
                                                            var modal = document.createElement('div');
                                                            modal.id = 'photoModal';
                                                            modal.style.position = 'fixed';
                                                            modal.style.top = 0;
                                                            modal.style.left = 0;
                                                            modal.style.width = '100vw';
                                                            modal.style.height = '100vh';
                                                            modal.style.background = 'rgba(0,0,0,0.8)';
                                                            modal.style.display = 'flex';
                                                            modal.style.alignItems = 'center';
                                                            modal.style.justifyContent = 'center';
                                                            modal.style.zIndex = 9999;
                                                            modal.innerHTML = `
                                                                <img src="${img.src}" style="max-width:90vw;max-height:90vh;border-radius:8px;box-shadow:0 0 20px #000;">
                                                                <span style="position:absolute;top:30px;right:40px;font-size:3rem;color:#fff;cursor:pointer;font-weight:bold;z-index:10000;" id="closePhotoModal">&times;</span>
                                                            `;
                                                            document.body.appendChild(modal);
                                                            document.getElementById('closePhotoModal').onclick = function() {
                                                                modal.remove();
                                                            };
                                                            modal.onclick = function(e) {
                                                                if (e.target === modal) modal.remove();
                                                            };
                                                        };
                                                    });
                                                }, 100);

                                            // Show modal (Bootstrap 4/5 compatible)
                                            var modal = document.getElementById('bridgeModal');
                                            if (typeof $ !== 'undefined' && typeof $.fn.modal === 'function') {
                                                // Bootstrap 4
                                                $(modal).modal('show');
                                            } else if (modal && modal.classList) {
                                                // Fallback for Bootstrap 5
                                                modal.classList.add('show');
                                                modal.style.display = 'block';
                                                modal.removeAttribute('aria-hidden');
                                                modal.setAttribute('aria-modal', 'true');
                                            }
                                        }

                                        // Close modal helper
                                        function closeBridgeModal() {
                                            var modal = document.getElementById('bridgeModal');
                                            if (typeof $ !== 'undefined' && typeof $.fn.modal === 'function') {
                                                $(modal).modal('hide');
                                            } else if (modal && modal.classList) {
                                                modal.classList.remove('show');
                                                modal.style.display = 'none';
                                                modal.setAttribute('aria-hidden', 'true');
                                                modal.removeAttribute('aria-modal');
                                            }
                                        }

                                        map.addLayer(markers);

                                        // Expose markerRefs and map for table click
                                        window.bridgeMapData = { markerRefs, map, bridges };
                                    </script>
                                </div>
                            </div>
                        </div>
                        <div class="col-xl-7">
                            <div class="card-box" style="height: 851px; overflow-y: auto;">
                                <h4 class="header-title mb-4">Data Jembatan</h4>
                                <div>
                                    <table class="table table-hover m-0 tickets-list table-actions-bar dt-responsive nowrap"
                                        style="border-collapse: collapse; border-spacing: 0; width: 100%;" id="datatable">
                                        <thead>
                                            <tr>
                                                <th>
                                                    Nomor Jembatan
                                                </th>
                                                <th>Lokasi</th>
                                                <th>STA</th>
                                                <th>Panjang</th>
                                                <th>Lebar</th>
                                                <th>Tahun Dibangun</th>
                                                <th>Kondisi</th>
                                                <th>Terakhir Inspeksi</th>
                                            </tr>
                                        </thead>

                                        <tbody>
                                            <tr data-bridge="Jembatan Mahakam">
                                                <td>P.34.00.001</td>
                                                <td>Lok Bahu, Samarinda Ulu, Samarinda</td>
                                                <td>-</td>
                                                <td>710</td>
                                                <td>15</td>
                                                <td>-</td>
                                                <td><span class="badge badge-success">Baik</span></td>
                                                <td>-</td>
                                            </tr>
                                            <tr data-bridge="Jembatan Kartanegara">
                                                <td>P.34.00.002</td>
                                                <td>Tenggarong, Tenggarong, Kutai Kartanegara</td>
                                                <td>-</td>
                                                <td>1022</td>
                                                <td>21</td>
                                                <td>-</td>
                                                <td><span class="badge badge-success">Baik</span></td>
                                                <td>-</td>
                                            </tr>
                                            <tr data-bridge="Jembatan Pulau Balang">
                                                <td>P.34.00.003</td>
                                                <td>Karang Joang, Balikpapan Utara, Balikpapan</td>
                                                <td>-</td>
                                                <td>540</td>
                                                <td>12</td>
                                                <td>-</td>
                                                <td><span class="badge badge-success">Baik</span></td>
                                                <td>-</td>
                                            </tr>
                                            <tr data-bridge="Jembatan Sungai Wain">
                                                <td>P.34.00.004</td>
                                                <td>Sungai Wain, Balikpapan Utara, Balikpapan</td>
                                                <td>-</td>
                                                <td>280</td>
                                                <td>8</td>
                                                <td>-</td>
                                                <td><span class="badge badge-success">Baik</span></td>
                                                <td>-</td>
                                            </tr>
                                            <tr data-bridge="Jembatan Benuo Taka">
                                                <td>P.34.00.005</td>
                                                <td>Benuo Taka, Penajam, Penajam Paser Utara</td>
                                                <td>-</td>
                                                <td>450</td>
                                                <td>14</td>
                                                <td>-</td>
                                                <td><span class="badge badge-success">Baik</span></td>
                                                <td>-</td>
                                            </tr>
                                            <tr data-bridge=" Simp. 4 Jalan Teuku Umar Lok Bahu, Samarinda">
                                                <td>P.34.00.006</td>
                                                <td>Melak, Melak, Kutai Barat</td>
                                                <td>-</td>
                                                <td>350</td>
                                                <td>10</td>
                                                <td>-</td>
                                                <td><span class="badge badge-success">Baik</span></td>
                                                <td>-</td>
                                            </tr>
                                            <tr data-bridge="Jembatan Berau">
                                                <td>P.34.00.007</td>
                                                <td>Tanjung Redeb, Tanjung Redeb, Berau</td>
                                                <td>-</td>
                                                <td>400</td>
                                                <td>11</td>
                                                <td>-</td>
                                                <td><span class="badge badge-success">Baik</span></td>
                                                <td>-</td>
                                            </tr>
                                            <tr data-bridge="Jembatan Bontang">
                                                <td>P.34.00.008</td>
                                                <td>Bontang Kuala, Bontang Utara, Bontang</td>
                                                <td>-</td>
                                                <td>320</td>
                                                <td>9</td>
                                                <td>-</td>
                                                <td><span class="badge badge-success">Baik</span></td>
                                                <td>-</td>
                                            </tr>
                                            <tr data-bridge="Jembatan Paser">
                                                <td>P.34.00.009</td>
                                                <td>Tanah Grogot, Tanah Grogot, Paser</td>
                                                <td>-</td>
                                                <td>500</td>
                                                <td>13</td>
                                                <td>-</td>
                                                <td><span class="badge badge-warning">Perlu Perbaikan</span></td>
                                                <td>-</td>
                                            </tr>
                                            <tr data-bridge="Jembatan Kutai Timur">
                                                <td>P.34.00.010</td>
                                                <td>Sangatta, Sangatta Utara, Kutai Timur</td>
                                                <td>-</td>
                                                <td>600</td>
                                                <td>12</td>
                                                <td>-</td>
                                                <td><span class="badge badge-success">Baik</span></td>
                                                <td>-</td>
                                            </tr>
                                            <tr data-bridge="Jembatan Mahakam Ulu">
                                                <td>P.34.00.011</td>
                                                <td>Long Bagun, Long Bagun, Mahakam Ulu</td>
                                                <td>-</td>
                                                <td>350</td>
                                                <td>10</td>
                                                <td>-</td>
                                                <td><span class="badge badge-danger">Kritis</span></td>
                                                <td>-</td>
                                            </tr>
                                            <tr data-bridge="Jembatan Loa Janan">
                                                <td>P.34.00.012</td>
                                                <td>Loa Janan, Loa Janan, Kutai Kartanegara</td>
                                                <td>-</td>
                                                <td>420</td>
                                                <td>11</td>
                                                <td>-</td>
                                                <td><span class="badge badge-success">Baik</span></td>
                                                <td>-</td>
                                            </tr>
                                            <tr data-bridge="Jembatan Samboja">
                                                <td>P.34.00.013</td>
                                                <td>Samboja, Samboja, Kutai Kartanegara</td>
                                                <td>-</td>
                                                <td>390</td>
                                                <td>10</td>
                                                <td>-</td>
                                                <td><span class="badge badge-warning">Perlu Perbaikan</span></td>
                                                <td>-</td>
                                            </tr>
                                            <tr data-bridge="Jembatan Muara Badak">
                                                <td>P.34.00.014</td>
                                                <td>Muara Badak, Muara Badak, Kutai Kartanegara</td>
                                                <td>-</td>
                                                <td>370</td>
                                                <td>9</td>
                                                <td>-</td>
                                                <td><span class="badge badge-success">Baik</span></td>
                                                <td>-</td>
                                            </tr>
                                            <tr data-bridge="Jembatan Penajam">
                                                <td>P.34.00.015</td>
                                                <td>Penajam, Penajam, Penajam Paser Utara</td>
                                                <td>-</td>
                                                <td>410</td>
                                                <td>12</td>
                                                <td>-</td>
                                                <td><span class="badge badge-success">Baik</span></td>
                                                <td>-</td>
                                            </tr>
                                            <tr data-bridge="Jembatan Talisayan">
                                                <td>P.34.00.016</td>
                                                <td>Talisayan, Talisayan, Berau</td>
                                                <td>-</td>
                                                <td>330</td>
                                                <td>8</td>
                                                <td>-</td>
                                                <td><span class="badge badge-success">Baik</span></td>
                                                <td>-</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <script>
                                        $(document).ready(function () {
                                            $('#datatable').DataTable({
                                                "pageLength": 5,
                                                "lengthMenu": [[5, 10, 25, 50, 100], [5, 10, 25, 50, 100]]
                                            });
                                        });
                                    </script>
                                </div>
                                <script>
                                    // Wait until DOM and map are ready
                                    document.addEventListener('DOMContentLoaded', function () {
                                        // Wait for map to be initialized
                                        function setupTableMapInteraction() {
                                            if (!window.bridgeMapData) {
                                                setTimeout(setupTableMapInteraction, 100);
                                                return;
                                            }
                                            var { markerRefs, map } = window.bridgeMapData;
                                            var rows = document.querySelectorAll('#datatable tbody tr[data-bridge]');
                                            rows.forEach(function (row) {
                                                row.style.cursor = 'pointer';
                                                row.addEventListener('click', function () {
                                                    var bridgeName = row.getAttribute('data-bridge');
                                                    var marker = markerRefs[bridgeName];
                                                    if (marker) {
                                                        var latlng = marker.getLatLng();
                                                        map.setView(latlng, 13, { animate: true });
                                                        marker.openPopup();
                                                    }
                                                });
                                            });
                                        }
                                        setupTableMapInteraction();
                                    });
                                </script>
                            </div>
                        </div>
                    </div>
                    <!-- end row -->

                    
                    <div class="row">
                        <div class="col-xl-6">
                            <div class="card-box">
                                <h4 class="header-title mb-4">Distribusi Kondisi Jembatan</h4>
                                <div>
                                    <div class="mb-1">
                                        <span>Kondisi Baik</span>
                                        <div class="progress" style="height: 37px;">
                                            <div class="progress-bar bg-success" role="progressbar"
                                                style="width: 65%; font-size: 1.2rem;" aria-valuenow="65"
                                                aria-valuemin="0" aria-valuemax="100">65%</div>
                                        </div>
                                    </div>
                                    <div class="mb-1">
                                        <span>Rusak Ringan</span>
                                        <div class="progress" style="height: 37px;">
                                            <div class="progress-bar bg-warning" role="progressbar"
                                                style="width: 25%; font-size: 1.2rem;" aria-valuenow="25"
                                                aria-valuemin="0" aria-valuemax="100">25%</div>
                                        </div>
                                    </div>
                                    <div class="mb-1">
                                        <span>Rusak Berat</span>
                                        <div class="progress" style="height: 37px;">
                                            <div class="progress-bar bg-danger" role="progressbar"
                                                style="width: 10%; font-size: 1.2rem;" aria-valuenow="10"
                                                aria-valuemin="0" aria-valuemax="100">10%</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="col-xl-6">
                            <div class="card-box">
                                <h4 class="header-title mb-4">Jembatan per Kabupaten/Kota</h4>
                                <div>
                                    <div class="mb-2">
                                        <span>Paser</span>
                                        <div class="progress" style="height: 24px;">
                                            <div class="progress-bar bg-primary" role="progressbar" style="width: 20%;"
                                                aria-valuenow="20" aria-valuemin="0" aria-valuemax="100">20%</div>
                                        </div>
                                    </div>
                                    <div class="mb-2">
                                        <span>Kutai Kartanegara</span>
                                        <div class="progress" style="height: 24px;">
                                            <div class="progress-bar bg-danger" role="progressbar" style="width: 18%;"
                                                aria-valuenow="18" aria-valuemin="0" aria-valuemax="100">18%</div>
                                        </div>
                                    </div>
                                    <div class="mb-2">
                                        <span>Samarinda</span>
                                        <div class="progress" style="height: 24px;">
                                            <div class="progress-bar bg-warning" role="progressbar" style="width: 12%;"
                                                aria-valuenow="12" aria-valuemin="0" aria-valuemax="100">12%</div>
                                        </div>
                                    </div>
                                    <div id="kabupaten-lainnya" style="display: none;">
                                        <div class="mb-2">
                                            <span>Penajam Paser Utara</span>
                                            <div class="progress" style="height: 24px;">
                                                <div class="progress-bar bg-info" role="progressbar" style="width: 10%;"
                                                    aria-valuenow="10" aria-valuemin="0" aria-valuemax="100">10%</div>
                                            </div>
                                        </div>
                                        <div class="mb-2">
                                            <span>Balikpapan</span>
                                            <div class="progress" style="height: 24px;">
                                                <div class="progress-bar bg-success" role="progressbar"
                                                    style="width: 8%;" aria-valuenow="8" aria-valuemin="0"
                                                    aria-valuemax="100">8%</div>
                                            </div>
                                        </div>
                                        <div class="mb-2">
                                            <span>Kutai Barat</span>
                                            <div class="progress" style="height: 24px;">
                                                <div class="progress-bar bg-secondary" role="progressbar"
                                                    style="width: 9%;" aria-valuenow="9" aria-valuemin="0"
                                                    aria-valuemax="100">9%</div>
                                            </div>
                                        </div>
                                        <div class="mb-2">
                                            <span>Mahakam Ulu</span>
                                            <div class="progress" style="height: 24px;">
                                                <div class="progress-bar bg-dark" role="progressbar" style="width: 3%;"
                                                    aria-valuenow="3" aria-valuemin="0" aria-valuemax="100">3%</div>
                                            </div>
                                        </div>
                                        <div class="mb-2">
                                            <span>Bontang</span>
                                            <div class="progress" style="height: 24px;">
                                                <div class="progress-bar bg-info" role="progressbar" style="width: 5%;"
                                                    aria-valuenow="5" aria-valuemin="0" aria-valuemax="100">5%</div>
                                            </div>
                                        </div>
                                        <div class="mb-2">
                                            <span>Kutai Timur</span>
                                            <div class="progress" style="height: 24px;">
                                                <div class="progress-bar bg-primary" role="progressbar"
                                                    style="width: 10%;" aria-valuenow="10" aria-valuemin="0"
                                                    aria-valuemax="100">10%</div>
                                            </div>
                                        </div>
                                        <div class="mb-2">
                                            <span>Berau</span>
                                            <div class="progress" style="height: 24px;">
                                                <div class="progress-bar bg-success" role="progressbar"
                                                    style="width: 5%;" aria-valuenow="5" aria-valuemin="0"
                                                    aria-valuemax="100">5%</div>
                                            </div>
                                        </div>
                                    </div>
                                    <button id="btn-selengkapnya" class="btn btn-link btn-sm mt-2"
                                        onclick="toggleKabupatenLainnya()">Selengkapnya</button>
                                </div>
                                <script>
                                    function toggleKabupatenLainnya() {
                                        var x = document.getElementById("kabupaten-lainnya");
                                        var btn = document.getElementById("btn-selengkapnya");
                                        if (x.style.display === "none") {
                                            x.style.display = "block";
                                            btn.textContent = "Lebih Sedikit";
                                        } else {
                                            x.style.display = "none";
                                            btn.textContent = "Selengkapnya";
                                        }
                                    }
                                </script>
                            </div>
                        </div>
                    </div>
                    <!-- end row -->
                </div>

                <!--- end row -->

            </div> <!-- end container-fluid -->

        </div> <!-- end content -->



        <!-- Footer Start -->
        <footer class="footer">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-md-12">
                        2025 &copy;Widya Aika  <a href="">hardygraph</a>
                    </div>
                </div>
            </div>
        </footer>
        <!-- end Footer -->

    </div>

    <!-- ============================================================== -->
    <!-- End Page content -->
    <!-- ============================================================== -->

    </div>
    <!-- END wrapper -->

    <!-- Right Sidebar -->
    <div class="right-bar">
        <div class="rightbar-title">
            <a href="javascript:void(0);" class="right-bar-toggle float-right">
                <i class="mdi mdi-close"></i>
            </a>
            <h4 class="font-16 m-0 text-white">Theme</h4>
        </div>
        <div class="slimscroll-menu">

            <div class="p-3">
                <!-- <div class="alert alert-warning" role="alert">
                    <strong>Customize </strong> the overall color scheme, layout, etc.
                </div> -->
                <div class="mb-2">
                    <img src="assets/images/layouts/light.png" class="img-fluid img-thumbnail" alt="">
                </div>
                <div class="custom-control custom-switch mb-3">
                    <input type="checkbox" class="custom-control-input theme-choice" id="light-mode-switch" checked />
                    <label class="custom-control-label" for="light-mode-switch">Light Mode</label>
                </div>

                <div class="mb-2">
                    <img src="assets/images/layouts/dark.png" class="img-fluid img-thumbnail" alt="">
                </div>
                <div class="custom-control custom-switch mb-3">
                    <input type="checkbox" class="custom-control-input theme-choice" id="dark-mode-switch"
                        data-bsStyle="assets/css/bootstrap-dark.min.css" data-appStyle="assets/css/app-dark.min.css" />
                    <label class="custom-control-label" for="dark-mode-switch">Dark Mode</label>
                </div>
            </div>
        </div> <!-- end slimscroll-menu-->
    </div>
    <!-- /Right-bar -->

    <!-- Right bar overlay-->
    <div class="rightbar-overlay"></div>

    <a href="javascript:void(0);" class="right-bar-toggle demos-show-btn">
        <i class="mdi mdi-settings-outline mdi-spin"></i> &nbsp;Choose Theme
    </a>

    <!-- Vendor js -->
    <script src="assets/js/vendor.min.js"></script>

    <!--C3 Chart-->
    <script src="assets/libs/d3/d3.min.js"></script>
    <script src="assets/libs/c3/c3.min.js"></script>

    <script src="assets/libs/echarts/echarts.min.js"></script>

    <script src="assets/js/pages/dashboard.init.js"></script>

    <!-- App js -->
    <script src="assets/js/app.min.js"></script>

    <!-- third party js -->
    <script src="assets/libs/datatables/jquery.dataTables.min.js"></script>
    <script src="assets/libs/datatables/dataTables.bootstrap4.min.js"></script>
    <script src="assets/libs/datatables/dataTables.responsive.min.js"></script>

    <!-- Tickets js -->
    <script src="assets/js/pages/tickets.init.js"></script>

</body>

</html>